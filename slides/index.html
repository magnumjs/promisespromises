<!doctype html>

<!--
  Slides based on Google's HTML5slides: http://code.google.com/p/html5slides/
-->

<html>
  <head>
    <title>Promises, Promises</title>

    <meta charset='utf-8'>
    <script
      src='slides.js'></script>
      
    <style>
    section.slides.template-async article.biglogo {
      background: white url(images/async-logo.png) 50% 50% no-repeat;
    }
    
	/*
    section.slides.template-async > article:not(.nobackground):not(.biglogo) {
      background: url(images/async-logo-small.png) 820px 625px no-repeat;
      background-color: white;  
    }
	*/
    
    p.smaller {
      font-size: 20px;
      line-height: 32px;
      letter-spacing: 0;
    }
    
    .spacious {
      margin-top:64px;
    }
	
	article pre {
		max-height:560px;
		overflow:scroll;
	}
    </style>
  </head>

  <body style='display: none'><!-- TODO: make non-JS friendly -->

    <section class='slides layout-regular template-async'>
      <article class='biglogo'>
      </article>

      <article>
        <h1>
          Promises, Promises
        </h1>
        <p>
          Premasagar Rose, Dharmafly
        </p>
        
        <p class='smaller spacious'>
          <strong><a href="http://asyncjs.com/promises/">Async</a></strong> – 9th February, 2012
          <br>
          <strong>Slides</strong> – <a href="https://github.com/premasagar/promises-slides">github.com/premasagar/promises-slides</a>
        
          <br>
          <strong>☄</strong> – <a href="https://twitter.com/premasagar">@premasagar</a> ╱ <a href="http://premasagar.com">premasagar.com</a> ╱ <a href="http://dharmafly.com">dharmafly.com</a>
        </p>
      </article>
      
      <article>
        <h2>
          Asynchronicity
        </h2>
        
        <p>Make a request...</p>
        <p>... wait... (get on with something else)...</p>
        <p>... get a response.</p>
		<p>Do something with the response.</p>
      </article>
      
      <article>
        <h3>
          Ajax, a quick recap
        </h3>
<pre>
var url = "http://asyncjs.com",
    xhr = new XMLHttpRequest();

xhr.open("GET", url, true);
xhr.onreadystatechange = function(event){
  if (xhr.readyState === 4) { // request complete
    if (xhr.status === 200) { // done
      foo(xhr.responseText);
    }
    else { // fail
      bar(xhr.statusText);
    }
  }  
};
xhr.send(null);
</pre>
    </article>
      
      <article>
        <h3>
          Ajax, in jQuery
        </h3>
<pre>
jQuery.ajax(url, {
  success: function(data){}, // done
  error: function(){}        // fail
});
</pre>

	<p>jQuery has numerous <a href="http://api.jquery.com/category/ajax/">Ajax helper functions</a>, <code>.get()</code>, <code>.getJSON()</code>, <code>.post()</code>, etc.</p>
	
	<!--<p>(Spoiler: jQuery now returns <em>promises</em> from each of these methods)</p>-->
    </article>
      
      <article>
        <h2>
          So far, so good
        </h2>
      </article>
			

      
      <article>
        <h3>
          Multiple requests, tangled mess
        </h3>
		
		<p>If many requests are required, e.g. to render an interface, you get <em>chaos</em>.</p>
	  </article>
		  
		  
      <article>
        <h3>
          Too tightly coupled
        </h3>

<pre>
var counter = 0, numRequests = 10;
    
jQuery.ajax(url1, {
  success: function(data){
    counter += 1;
    if (counter === numRequests){
      doSomething1(data);
    }
  },
  error: onError
});

jQuery.ajax(url2, {
	
	// etc ...

</pre>
      </article>

      
      <article>
        <h3>
          Multiple requests
        </h3>
			
				<ul>
					<li>Counters outside of callbacks</li>
					<li>Brittle code</li>
					<li>Increasing complexity</li>
					<li>Separate components can't subscribe to callbacks</li>
					<li>Can't add callbacks after request is made</li>
				</ul>
			
	</article>
      
	  
	  
      
      <article>
        <h2>
          The promise of Promises
        </h2>
      </article>
	  
      <!--
      <article class='smaller'>
        <h3>
          Promises
        </h3>
		<div class='build'>
        <q>
		  <span>Promises provide a <em>well-defined interface</em></span> <span class='build'><span>for interacting with an object</span> <span>that represents <em>the result of an action</em></span> <span>that is performed asynchronously.</span></span>
        </q>
		</div>
		
        <div class='author'>
          <a href='http://wiki.commonjs.org/wiki/Promises'>wiki.commonjs.org/wiki/Promises</a>
        </div>
      </article>
	  -->
	  
      <article>
        <h3>
          Promises
        </h3>
		
		<div class='build'>
		
			<p style='margin-top:48px;'>An object that can be interacted with, while waiting for the result of an action.</p>
		
			<p>May be in one of the 3 states:</p>
			<ul>
				<li>unfulfilled</li>
				<li>fulfilled</li>
				<li>failed</li>
			</ul>
				<p>The promise may only move from <em>unfulfilled to fulfilled</em>
				<br>or <em>unfulfilled to failed</em>.</p>
			
		</div>
      </article>
	  
		
	<!-- Inspired by Dojo's "Deferred", which inherited from MochiKit and Python's Twisted -->
	
		
      <article>
        <h3><code>then</code> method</h3>
		
		<!--
		<p>jQuery's <a href="http://api.jquery.com/category/deferred-object/">Deferred</a> is based on CommonJS's <a href="http://wiki.commonjs.org/wiki/Promises/A">Promises/A</a> pattern.</p>
		-->
			
<pre>
then(fulfilledHandler, errorHandler, progressHandler);
</pre>

	<ul>
		<li>All arguments optional</li>
		<li><strong>fulfilledHandler</strong> - called when the promise is fulfilled</li>
		<li><strong>errorHandler</strong> - called if the promise fails</li>
		<li><strong>progressHandler</strong> - may be called as promise progresses</li>
		<li>The <code>then</code> function returns a <em>new promise</em>, to allow chaining.</li>
	</ul>
      </article>
      
      
	  jQuery.then
	  jQuery's Ajax calls return promises
	  (also animation functions)
	  jQuery when
	  
	  demos...
	  
	  libraries
	  
      <article class='smaller'>
        <h3>
          Simple slide with header and text (small font)
        </h3>
        <p>
          This is a slide with just text. This is a slide with just text.
          This is a slide with just text. This is a slide with just text.
          This is a slide with just text. This is a slide with just text.
        </p>
        <p>
          There is more text just underneath with a <code>code sample: 5px</code>.
        </p>
      </article>

      <article>
        <h3>
          Slide with bullet points and a longer title, just because we
          can make it longer
        </h3>
        <ul>
          <li>
            Use this template to create your presentation
          </li>
          <li>
            Use the provided color palette, box and arrow graphics, and
            chart styles
          </li>
          <li>
            Instructions are provided to assist you in using this
            presentation template effectively
          </li>
          <li>
            At all times strive to maintain Google's corporate look and feel
          </li>
        </ul>
      </article>

      <article>
        <h3>
          Slide with bullet points that builds
        </h3>
        <ul class="build">
          <li>
            This is an example of a list
          </li>
          <li>
            The list items fade in
          </li>
          <li>
            Last one!
          </li>
        </ul>

        <div class="build">
          <p>Any element with child nodes can build.</p>
          <p>It doesn't have to be a list.</p>
        </div>
      </article>

      <article class='smaller'>
        <h3>
          Slide with bullet points (small font)
        </h3>
        <ul>
          <li>
            Use this template to create your presentation
          <li>
            Use the provided color palette, box and arrow graphics, and
            chart styles
          <li>
            Instructions are provided to assist you in using this
            presentation template effectively
          <li>
            At all times strive to maintain Google's corporate look and feel
        </ul>
      </article>

      <article>
        <h3>
          Slide with a table
        </h3>
        
        <table>
          <tr>
            <th>
              Name
            <th>
              Occupation
          <tr>
            <td>
              Luke Mahé
            <td>
              V.P. of Keepin’ It Real
          <tr>
            <td>
              Marcin Wichary
            <td>
              The Michael Bay of Doodles
        </table>
      </article>
      
      <article class='smaller'>
        <h3>
          Slide with a table (smaller text)
        </h3>
        
        <table>
          <tr>
            <th>
              Name
            <th>
              Occupation
          <tr>
            <td>
              Luke Mahé
            <td>
              V.P. of Keepin’ It Real
          <tr>
            <td>
              Marcin Wichary
            <td>
              The Michael Bay of Doodles
        </table>
      </article>
      
      <article>
        <h3>
          Styles
        </h3>
        <ul>
          <li>
            <span class='red'>class="red"</span>
          <li>
            <span class='blue'>class="blue"</span>
          <li>
            <span class='green'>class="green"</span>
          <li>
            <span class='yellow'>class="yellow"</span>
          <li>
            <span class='black'>class="black"</span>
          <li>
            <span class='white'>class="white"</span>
          <li>
            <b>bold</b> and <i>italic</i>
        </ul>
      </article>
      
      <article>
        <h2>
          Segue slide
        </h2>
      </article>

      <article>
        <h3>
          Slide with an image
        </h3>
        <p>
          <img style='height: 500px' src='images/example-graph.png'>
        </p>
        <div class='source'>
          Source: Sergey Brin
        </div>
      </article>

      <article>
        <h3>
          Slide with an image (centered)
        </h3>
        <p>
          <img class='centered' style='height: 500px' src='images/example-graph.png'>
        </p>
        <div class='source'>
          Source: Larry Page
        </div>
      </article>

      <article class='fill'>
        <h3>
          Image filling the slide (with optional header)
        </h3>
        <p>
          <img src='images/example-cat.jpg'>
        </p>
        <div class='source white'>
          Source: Eric Schmidt
        </div>
      </article>

      <article>
        <h3>
          This slide has some code
        </h3>
        <section>
        <pre>
&lt;script type='text/javascript'&gt;
  // Say hello world until the user starts questioning
  // the meaningfulness of their existence.
  function helloWorld(world) {
    for (var i = 42; --i &gt;= 0;) {
      alert('Hello ' + String(world));
    }
  }
&lt;/script&gt;
&lt;style&gt;
  p { color: pink }
  b { color: blue }
  u { color: 'umber' }
&lt;/style&gt;
</pre>
        </section>
      </article>
      
      <article class='smaller'>
        <h3>
          This slide has some code (small font)
        </h3>
        <section>
        <pre>
&lt;script type='text/javascript'&gt;
  // Say hello world until the user starts questioning
  // the meaningfulness of their existence.
  function helloWorld(world) {
    for (var i = 42; --i &gt;= 0;) {
      alert('Hello ' + String(world));
    }
  }
&lt;/script&gt;
&lt;style&gt;
  p { color: pink }
  b { color: blue }
  u { color: 'umber' }
&lt;/style&gt;
</pre>
        </section>
      </article>
      
      <article>
        <q>
          The best way to predict the future is to invent it.
        </q>
        <div class='author'>
          Alan Kay
        </div>
      </article>
      
      <article class='smaller'>
        <q>
          A distributed system is one in which the failure of a computer 
          you didn’t even know existed can render your own computer unusable.
        </q>
        <div class='author'>
          Leslie Lamport
        </div>
      </article>
      
      <article class='nobackground'>
        <h3>
          A slide with an embed + title
        </h3>
        
        <iframe src='http://www.google.com/doodle4google/history.html'></iframe>
      </article>

      <article class='nobackground'>
        <iframe src='http://www.google.com/doodle4google/history.html'></iframe>
      </article>

      <article class='fill'>
        <h3>
          Full-slide embed with (optional) slide title on top
        </h3>
        <iframe src='http://www.google.com/doodle4google/history.html'></iframe>
      </article>
      
      <article>
        <h3>
          Thank you!
        </h3>
        
        <ul>
          <li>
            <a href='http://www.google.com'>google.com</a>
        </ul>
      </article>

    </section>

  </body>
</html>
